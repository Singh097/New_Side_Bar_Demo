<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Work Report App</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
/* --- Styles same as your previous code --- */
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; }
.login-container { display:flex; justify-content:center; align-items:center; height:100vh; background: linear-gradient(135deg, #6B73FF 0%, #000DFF 100%); }
.login-box { background:white; padding:40px; border-radius:12px; box-shadow:0 10px 25px rgba(0,0,0,0.2); width:380px; text-align:center; position:relative; overflow:hidden; }
.login-box h2 { margin-bottom:15px; color:#333; font-weight:700; font-family:'Segoe UI', sans-serif; }
.login-box p { color:#666; font-size:14px; margin-bottom:20px; }
.login-box input { width:100%; padding:12px 15px; margin-bottom:12px; border-radius:8px; border:1px solid #ccc; outline:none; font-size:14px; transition:0.3s; }
.login-box input:focus { border-color:#4CAF50; box-shadow:0 0 5px rgba(76,175,80,0.2); }
.login-box button { width:100%; padding:12px; border:none; border-radius:8px; background: #4CAF50; color:white; font-weight:600; cursor:pointer; transition: 0.3s; }
.login-box button:hover { background:#45a049; }
.login-box .forgot-pass { margin-top:10px; font-size:12px; color:#999; }
.login-box .forgot-pass a { color:#4CAF50; text-decoration:none; }
.login-box .circle1 { position:absolute; top:-50px; right:-50px; width:150px; height:150px; background:rgba(255,255,255,0.1); border-radius:50%; }
.login-box .circle2 { position:absolute; bottom:-60px; left:-60px; width:200px; height:200px; background:rgba(255,255,255,0.05); border-radius:50%; }
.app-wrapper { display:none; min-height:100vh; }
.layout { display:flex; gap:0; min-height:100vh; }
.sidebar { width: 320px; background-color: #fdfdfd; padding: 20px; border-right: 1px solid #ccc; display: flex; flex-direction: column; justify-content: space-between; }
.profile-card { display: flex; align-items: center; margin-bottom: 20px; }
.profile-pic { width: 50px; height: 50px; border-radius: 50%; margin-right: 15px; background-size: cover; }
.profile-info { font-size: 14px; }
.menu-title { cursor: pointer; font-weight: bold; padding: 12px 15px; border-radius: 8px; font-size: 16px; color: white; }
.menu-items { margin-top: 10px; margin-left: 10px; display: none; }
.menu-items li { margin: 6px 0; list-style: none; padding: 8px 12px; background: #fff; border-radius: 6px; border: 1px solid #ddd; cursor: pointer; }
.submenu { display: none; margin-left: 20px; }
.submenu li { font-size: 14px; background: #f9f9f9; }
.menu-items li i { margin-right: 8px; }
.tms-title { background: #4CAF50; }
.work-title { background: #2196F3; }
#main-area { flex-grow: 1; padding: 20px; display:block; background: #f8f8f8; }
#form-container { display: none; }
.form-row { display: flex; gap: 20px; margin-bottom: 20px; }
.form-col { flex: 1; display: flex; flex-direction: column; gap: 10px; }
label { font-weight: bold; margin-bottom: 5px; }
select, input[type="date"], input[type="text"], input[type="number"], textarea { padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 100%; }
textarea { resize: vertical; min-height: 80px; }
table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { background: #eee; }
.submit-btn { padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; }
.remove-btn { background: #e74c3c; color: white; border: none; padding: 6px 10px; border-radius: 4px; cursor: pointer; }
.logout-btn { padding: 10px; background: #f44336; color: white; border: none; border-radius: 6px; cursor: pointer; width: 100%; margin-top: 20px; }
.panel { background:white; padding:16px; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.05); margin-bottom:16px; }
.small { font-size:13px; color:#666; }
.action-btn { padding:6px 10px; border-radius:6px; border:none; cursor:pointer; }
.approve-btn { background:#2ecc71; color:white; }
.reject-btn { background:#e74c3c; color:white; }
.view-btn { background:#3498db; color:white; }
.hidden { display:none; }
.flex { display:flex; gap:10px; align-items:center; }
@media (max-width: 900px) { .layout { flex-direction: column; } .sidebar { width: 100%; order: 2; } #main-area { order: 1; } }
</style>
</head>
<body>

<!-- LOGIN SECTION -->
<div id="login-section" class="login-container">
    <div class="login-box">
        <h2>Welcome Back</h2>
        <p>Login to access your department forms</p>
        <input type="text" id="login-username" placeholder="Username" />
        <input type="password" id="login-password" placeholder="Password" />
        <div style="display:flex; gap:10px; margin-bottom:12px;">
            <label style="flex:1; display:flex; gap:8px; align-items:center;">
                <input type="checkbox" id="remember-me" /> Remember me
            </label>
            <button onclick="togglePassword()">Show</button>
        </div>
        <button onclick="loginUser()">Login</button>
        <div class="forgot-pass">Forgot your password? <a href="#" onclick="alert('For demo: use admin/hr/it/it_manager/finance')">Reset here</a></div>
        <div class="circle1"></div>
        <div class="circle2"></div>
    </div>
</div>

<!-- MAIN APP -->
<div class="app-wrapper" id="app-wrapper">
    <div class="layout">
        <div class="sidebar">
            <div>
                <div class="profile-card">
                    <div class="profile-pic" id="profile-pic"></div>
                    <div class="profile-info">
                        <strong id="user-name">User</strong><br>
                        <small id="user-email">user@example.com</small><br>
                        <small id="user-role" class="small">Role: -</small>
                    </div>
                </div>

                <div class="menu-section">
                    <div class="menu-title work-title" onclick="toggleMenu('work-menu')">Work Report</div>
                    <ul class="menu-items" id="work-menu">
                        <li class="dept hr" onclick="toggleSubMenu(event, 'hr-submenu')"><i class="fas fa-users"></i> HR Department</li>
                        <ul class="submenu hr" id="hr-submenu">
                            <li onclick="showForm(event, 'HR - Payroll')"><i class="fas fa-money-check-alt"></i> HR - Payroll</li>
                        </ul>
                        <li class="dept it" onclick="toggleSubMenu(event, 'it-submenu')"><i class="fas fa-laptop-code"></i> IT Department</li>
                        <ul class="submenu it" id="it-submenu">
                            <li onclick="showForm(event, 'IT - Development')"><i class="fas fa-code"></i> IT - Development</li>
                            <li onclick="showForm(event, 'IT - Support')"><i class="fas fa-headset"></i> IT - Support</li>
                        </ul>
                        <li class="dept finance" onclick="toggleSubMenu(event, 'finance-submenu')"><i class="fas fa-coins"></i> Finance Department</li>
                        <ul class="submenu finance" id="finance-submenu">
                            <li onclick="showForm(event, 'Finance - Audit')"><i class="fas fa-file-invoice"></i> Finance - Audit</li>
                            <li onclick="showForm(event, 'Finance - Budgeting')"><i class="fas fa-chart-line"></i> Finance - Budgeting</li>
                        </ul>
                        <li class="dept marketing" onclick="toggleSubMenu(event, 'marketing-submenu')"><i class="fas fa-bullhorn"></i> Marketing Department</li>
                        <ul class="submenu marketing" id="marketing-submenu">
                            <li onclick="showForm(event, 'Marketing - Campaigns')"><i class="fas fa-ad"></i> Marketing - Campaigns</li>
                            <li onclick="showForm(event, 'Marketing - Research')"><i class="fas fa-search"></i> Marketing - Research</li>
                        </ul>
                    </ul>
                </div>

                <div id="manager-dashboard" class="panel hidden">
                    <h3>Manager Panel</h3>
                    <ul style="padding-left:18px;">
                        <li><a href="#" onclick="viewDeptReports()">View Department Reports</a></li>
                        <li><a href="#" onclick="viewPendingForManager()">Pending Approvals</a></li>
                    </ul>
                </div>

                <div id="admin-dashboard" class="panel hidden">
                    <h3>Admin Panel</h3>
                    <ul style="padding-left:18px;">
                        <li><a href="#" onclick="viewAllReports()">View All Reports</a></li>
                        <li><a href="#" onclick="manageUsers()">Manage Users</a></li>
                    </ul>
                </div>
            </div>

            <button class="logout-btn" onclick="logoutUser()"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>

        <div id="main-area">
            <div id="form-container" class="panel">
                <h2 id="form-title">Work Report Form</h2>
                <div class="form-row">
                    <div class="form-col">
                        <label>Employee ID:</label>
                        <input type="text" id="employee-id" placeholder="Enter Employee ID" required />
                        <label>Date:</label>
                        <input type="date" id="report-date" required />
                    </div>
                    <div class="form-col">
                        <label>Status:</label>
                        <select id="status-select" onchange="toggleFormBody()" required>
                            <option value="">-- Select --</option>
                            <option value="Leave">Leave</option>
                            <option value="Half Day">Half Day</option>
                            <option value="Full Day">Full Day</option>
                            <option value="Short Leave">Short Leave</option>
                            <option value="Week Off">Week Off</option>
                        </select>

                        <label>Manager (auto)</label>
                        <input type="text" id="manager-name" readonly placeholder="Manager will be assigned automatically" />
                    </div>
                </div>

                <div id="form-body">
                    <table id="work-table">
                        <thead>
                            <tr>
                                <th>Sr No.</th>
                                <th>Work Done</th>
                                <th>Minimum Work</th>
                                <th>Time Util (Minutes)</th>
                                <th>Remarks</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3"><strong>Total Time:</strong></td>
                                <td colspan="3" id="total-time-cell"><strong>0:00</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                    <div style="display:flex; gap:10px;">
                        <button class="submit-btn" onclick="addRow()">+ Add Row</button>
                        <button class="submit-btn" onclick="saveDraft()">Save Draft</button>
                        <button class="submit-btn" onclick="loadMyDraft()">Load Draft</button>
                    </div>
                </div>
                <div style="margin-top:12px;">
                    <button class="submit-btn" onclick="submitForm()">Submit</button>
                    <button style="margin-left:8px;" onclick="viewMySubmissions()">My Submissions</button>
                </div>
            </div>
            <div id="panel-area"></div>
        </div>
    </div>
</div>

<script>
// --- DYNAMIC DATE SETUP ---
window.addEventListener('DOMContentLoaded', (event) => {
    const dateInput = document.getElementById('report-date');
    const today = new Date();
    const minDate = new Date(today); minDate.setDate(today.getDate() - 2);
    const formatDate = (d) => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
    dateInput.min = formatDate(minDate);
    dateInput.max = formatDate(today);
    dateInput.value = formatDate(today);
});

// --- All your JS logic from previous code goes here ---
// (Login, logout, form rows, drafts, manager/admin panels, etc.)
// Copy your previous script entirely here, but remove placeholders __TODAY__, __MIN_DATE__
</script>
</body>
</html>
